# **Project Constitution**

This document outlines the fundamental principles and non-negotiable standards for this project. All code, whether generated by an AI agent or written by a human developer, MUST adhere to these principles. The CI pipeline is the ultimate enforcer of this constitution.

## **1. Core Principles**

* **Clarity and Simplicity**: Code must be readable, maintainable, and as simple as possible, but no simpler. Prefer clear, explicit logic over clever, implicit magic.
* **Correctness and Robustness**: All code must be correct and handle edge cases gracefully. Defensive programming practices are encouraged.
* **Security First**: All code must be written with security in mind. Adhere to OWASP Top 10 principles. Never trust user input. Sanitize all data crossing trust boundaries.
* **Test-Driven Development (TDD)**: All new functionality must be accompanied by a comprehensive suite of automated tests. The implementation of tests must precede the implementation of the feature code, as reflected in the tasks.md file.

## **2. Code Quality Standards**

* **Linter and Formatter Adherence**: All Python code MUST conform to the rules defined in the [tool.ruff] section of the pyproject.toml file. No linting errors are permitted in the main branch.
* **Static Typing**: All Python code MUST use type hints as defined in PEP 484. The code MUST pass static analysis by mypy with the --strict flag, using the configuration in pyproject.toml.
* **Modularity**: Code should be organized into small, single-purpose functions and classes. Avoid large, monolithic files.
* **Naming Conventions**: Use snake_case for variables and functions. Use PascalCase for classes. Names should be descriptive and unambiguous.
* **Documentation**: All public functions, classes, and modules must have comprehensive docstrings in the Google style format.

## **3. Testing Mandates**

* **Test Coverage**: The automated test suite MUST achieve a minimum of 90% line and branch coverage for all new code. This will be enforced by the CI pipeline.
* **Types of Tests**:
  * **Unit Tests**: Every logical unit of code (function, method) must have corresponding unit tests.
  * **Integration Tests**: Key workflows and interactions between components must be covered by integration tests.
* **Test Location**: All tests must reside in the tests/ directory, mirroring the structure of the src/ directory.

## **4. Performance and Scalability**

* **API Response Times**: All synchronous API endpoints MUST respond in under 500ms at the 95th percentile under expected load.
* **Resource Consumption**: Code should be mindful of memory and CPU usage. Avoid inefficient algorithms and data structures for performance-critical paths.
* **Database Queries**: All database queries must be optimized. Avoid N+1 query problems. Use appropriate indexing.

## **5. Dependency Management**

* **Dependency Minimization**: Only add third-party dependencies when absolutely necessary. Prefer well-maintained, reputable libraries.
* **Versioning**: All dependencies must be pinned to specific versions in pyproject.toml to ensure reproducible builds.
